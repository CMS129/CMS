<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="utf-8">
    <title>完全开发手册</title>
    <meta name="applicable-device" content="pc,mobile">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0">
    <meta name="format-detection" content="telephone=no, email=no">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>
    <div id="__next">
        <div id="container" class="container">
            <main role="main">
                <section id="learn" class="row">
                    <div class="content col-12 col-md-9 col-lg-10">

                        <div>
                            <h1><a name="installation"></a>
                                <font _mstmutation="1" _msthash="643318" _msttexthash="5773755">安装</font>
                            </h1>
                            <p _msthash="394680" _msttexthash="45601023">1. 配置您的网络服务器。</p>
                            <p>
                                <font _mstmutation="1" _msthash="644462" _msttexthash="106457858">对于<em _mstmutation="1"
                                        _istranslated="1">Apache</em>，使用以下内容编辑文件：</font><code>.htaccess</code>
                            </p>
                            <pre><code>
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php [QSA,L]
                            </code></pre>
                            <p>
                                <font _mstmutation="1" _msthash="645164" _msttexthash="195766844"><strong
                                        _mstmutation="1" _istranslated="1">注意</strong>：如果您需要在子目录中使用CMS，请将 RewriteBase /subdir/ 添加到 RewriteEngine On。</font>
                                <code>RewriteBase /subdir/</code><code> On</code>
                            </p>
                            <p _msthash="396084" _msttexthash="129645243">对于<em
                                    _istranslated="1">Nginx</em>，将以下内容添加到服务器声明中：</p>
                            <pre><code>
server {
    location / {
        try_files $uri $uri/ /index.php;
    }
}
                            </code></pre>
                        </div>
                        <div>
                            <h1><a name="routing"></a>
                                <font _mstmutation="1" _msthash="402974" _msttexthash="6426589">路由</font>
                            </h1>
                            <p _msthash="388154" _msttexthash="134535895">CMS中的路由通过将 URL 模式与回调函数匹配完成。</p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'hello world!'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="388856" _msttexthash="204863256">回调可以是可调用的任何对象。因此，您可以使用常规函数：</p>
                            <pre class="language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'hello world!'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="389558" _msttexthash="21606663">或类方法：</p>
                            <pre class="language-php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name">Greeting</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">echo</span> <span class="token single-quoted-string string">'hello world!'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Greeting'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="390260" _msttexthash="26495508">或对象方法：</p>
                            <pre class="language-php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name">Greeting</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token this">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">name</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'John Doe'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">echo</span> <span class="token double-quoted-string string">"Hello, <span class="token interpolation"><span class="token punctuation">{</span><span class="token this">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">name</span><span class="token punctuation">}</span></span>!"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token variable">$greeting</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Greeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token variable">$greeting</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="390962" _msttexthash="188815783">路由按其定义的顺序匹配。将调用与请求匹配的第一个路由。</p>
                            <h2 _msthash="421772" _msttexthash="13418600">方法路由</h2>
                            <p _msthash="405990" _msttexthash="397341893">默认情况下，路由模式与所有请求方法匹配。您可以通过在 URL 之前放置标识符来响应特定方法。
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'GET /'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'I received a GET request.'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'POST /'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'I received a POST request.'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p>
                                <font _mstmutation="1" _msthash="406718" _msttexthash="133747796">还可以使用分隔符将多种方法映射到单个回调：
                                </font><code>|</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'GET|POST /'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'I received either a GET or a POST request.'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <h2 _msthash="423657" _msttexthash="17036734">正则表达式</h2>
                            <p _msthash="407810" _msttexthash="84339450">您可以在路由中使用正则表达式：</p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/user/[0-9]+'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// This will match /user/1234</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <h2 _msthash="424788" _msttexthash="10090561">命名参数</h2>
                            <p _msthash="408902" _msttexthash="132937090">您可以在路由中指定将传递给回调函数的命名参数。</p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/@name/@id'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"hello, <span class="token interpolation"><span class="token variable">$name</span></span> (<span class="token interpolation"><span class="token variable">$id</span></span>)!"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p>
                                <font _mstmutation="1" _msthash="406341" _msttexthash="162948747">
                                    还可以使用分隔符将正则表达式与命名参数一起包含：</font><code>:</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/@name/@id:[0-9]{3}'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// This will match /bob/123</span>
    <span class="token comment">// But will not match /bob/12345</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <h2 _msthash="423267" _msttexthash="11674663">可选参数</h2>
                            <p _msthash="407433" _msttexthash="139164220">您可以通过在括号中换行段来指定可选的可选参数。</p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/blog(/@year(/@month(/@day)))'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$year</span><span class="token punctuation">,</span> <span class="token variable">$month</span><span class="token punctuation">,</span> <span class="token variable">$day</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// This will match the following URLS:</span>
    <span class="token comment">// /blog/2012/12/10</span>
    <span class="token comment">// /blog/2012/12</span>
    <span class="token comment">// /blog/2012</span>
    <span class="token comment">// /blog</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="408161" _msttexthash="82241627">不匹配的任何可选参数都将以 NULL 表示。</p>
                            <h2 _msthash="424775" _msttexthash="10914020">通 配 符</h2>
                            <p>
                                <font _mstmutation="1" _msthash="408889" _msttexthash="223205333">仅对单个 URL
                                    段进行匹配。如果要匹配多个段，可以使用通配符。</font><code>*</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/blog/*'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// This will match /blog/2000/02/01</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="406328" _msttexthash="118214239">若要将所有请求路由到单个回调，可以：</p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'*'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// Do something</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <h2 _msthash="423254" _msttexthash="7184918">通过</h2>
                            <p>
                                <font _mstmutation="1" _msthash="407420" _msttexthash="175436768">
                                    您可以通过从回调函数返回将执行传递给下一个匹配路由。</font><code>true</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/user/@name'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// Check some condition</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$name</span> <span class="token operator">!=</span> <span class="token double-quoted-string string">"Bob"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Continue to next route</span>
        <span class="token keyword">return</span> <span class="token boolean constant">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/user/*'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// This will get called</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <h2 _msthash="424385" _msttexthash="12282816">路线信息</h2>
                            <p>
                                <font _mstmutation="1" _msthash="408512" _msttexthash="967036096">
                                    如果要检查匹配的路由信息，可以通过作为路由方法中的第三个参数传递来请求将路由对象传递给回调。路由对象始终是传递给回调函数的最后一个参数。</font>
                                <code>true</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$route</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// Array of HTTP methods matched against</span>
    <span class="token variable">$route</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">methods</span><span class="token punctuation">;</span>

    <span class="token comment">// Array of named parameters</span>
    <span class="token variable">$route</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">params</span><span class="token punctuation">;</span>

    <span class="token comment">// Matching regular expression</span>
    <span class="token variable">$route</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">regex</span><span class="token punctuation">;</span>

    <span class="token comment">// Contains the contents of any '*' used in the URL pattern</span>
    <span class="token variable">$route</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">splat</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                        </div>
                        <div>
                            <h1><a name="extending"></a>
                                <font _mstmutation="1" _msthash="402975" _msttexthash="4750811">扩展</font>
                            </h1>
                            <p _msthash="388155" _msttexthash="807186003">
                                CMS被设计为一个可扩展的框架。框架附带一组默认方法和组件，但它允许您映射自己的方法、注册自己的类，甚至重写现有类和方法。</p>
                            <h2 _msthash="404040" _msttexthash="11497655">映射方法</h2>
                            <p>
                                <font _mstmutation="1" _msthash="388857" _msttexthash="143905203">若要映射自己的自定义方法，请使用 以下函数：
                                </font><code>map</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token comment">// Map your method</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">map</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'hello'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token double-quoted-string string">"hello <span class="token interpolation"><span class="token variable">$name</span></span>!"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Call your custom method</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Bob'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <h2 _msthash="405132" _msttexthash="8436623">注册类</h2>
                            <p>
                                <font _mstmutation="1" _msthash="389909" _msttexthash="106687880">若要注册自己的类，请使用 以下函数：
                                </font><code>register</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token comment">// Register your class</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">register</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'user'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'User'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Get an instance of your class</span>
<span class="token variable">$user</span> <span class="token operator">=</span> <span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="390611" _msttexthash="1254156683">
                                寄存器方法还允许您将参数传递给类构造函数。因此，当您加载自定义类时，它将预先初始化。您可以通过传递其他数组来定义构造函数参数。下面是加载数据库连接的示例：</p>
                            <pre class="language-php"><code class="language-php"><span class="token comment">// Register class with constructor parameters</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">register</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'db'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'PDO'</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'mysql:host=localhost;dbname=test'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'user'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'pass'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Get an instance of your class</span>
<span class="token comment">// This will create an object with the defined parameters</span>
<span class="token comment">//</span>
<span class="token comment">//     new PDO('mysql:host=localhost;dbname=test','user','pass');</span>
<span class="token comment">//</span>
<span class="token variable">$db</span> <span class="token operator">=</span> <span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">db</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="405626" _msttexthash="733635539">
                                如果输入其他回调参数，将在类构造后立即执行。这允许您为新对象执行任何设置过程。回调函数采用一个参数，即新对象的实例。</p>
                            <pre class="language-php"><code class="language-php"><span class="token comment">// The callback will be passed the object that was constructed</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">register</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'db'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'PDO'</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'mysql:host=localhost;dbname=test'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'user'</span><span class="token punctuation">,</span><span class="token single-quoted-string string">'pass'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$db</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token scope">PDO<span class="token punctuation">::</span></span><span class="token constant">ATTR_ERRMODE</span><span class="token punctuation">,</span> <span class="token scope">PDO<span class="token punctuation">::</span></span><span class="token constant">ERRMODE_EXCEPTION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p>
                                <font _mstmutation="1" _msthash="406354" _msttexthash="445688295">
                                    默认情况下，每次加载类时，都会获得一个共享实例。要获取类的新实例，只需作为参数输入：</font><code>false</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token comment">// Shared instance of the class</span>
<span class="token variable">$shared</span> <span class="token operator">=</span> <span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">db</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// New instance of the class</span>
<span class="token variable">$new</span> <span class="token operator">=</span> <span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">db</span><span class="token punctuation">(</span><span class="token boolean constant">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="407082" _msttexthash="387594480">请记住，映射的方法优先于已注册的类。如果使用相同名称声明两者，则仅调用映射的方法。</p>
                        </div>
                        <div>
                            <h1><a name="overriding"></a>
                                <font _mstmutation="1" _msthash="402976" _msttexthash="5569031">重写</font>
                            </h1>
                            <p _msthash="388156" _msttexthash="279590012">CMS允许您覆盖其默认功能，以满足自己的需求，而无需修改任何代码。</p>
                            <p>
                                <font _mstmutation="1" _msthash="388505" _msttexthash="554690812">例如，当 Api 无法将 URL
                                    与路由匹配时，它会调用发送通用响应的方法。可以使用 以下方法重写此行为：</font>
                                <code>notFound</code><code>HTTP 404</code><code>map</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">map</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'notFound'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// Display custom 404 page</span>
    <span class="token keyword">include</span> <span class="token single-quoted-string string">'errors/404.html'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="389207" _msttexthash="424968245">CMS还允许您更换框架的核心组件。例如，您可以将默认路由器类替换为您自己的自定义类：</p>
                            <pre class="language-php"><code class="language-php"><span class="token comment">// Register your custom class</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">register</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'router'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'MyRouter'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// When Api loads the Router instance, it will load your class</span>
<span class="token variable">$myrouter</span> <span class="token operator">=</span> <span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p>
                                <font _mstmutation="1" _msthash="389910" _msttexthash="231934846">框架方法（如 和
                                    ）不能重写。如果您尝试这样做，您会收到错误。</font><code>map</code><code>register</code>
                            </p>
                        </div>
                        <div>
                            <h1><a name="filtering"></a>
                                <font _mstmutation="1" _msthash="402977" _msttexthash="5482204">筛选</font>
                            </h1>
                            <p _msthash="388157" _msttexthash="744395782">
                                CMS允许您在调用方法之前和之后进行筛选。没有需要记住的预定义挂钩。您可以筛选任何默认框架方法以及已映射的任何自定义方法。</p>
                            <p _msthash="388506" _msttexthash="46902492">筛选函数如下所示：</p>
                            <pre class="language-php"><code class="language-php"><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$params</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$output</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Filter code</span>
<span class="token punctuation">}</span>
</code></pre>
                            <p _msthash="389208" _msttexthash="132398734">使用传递的变量，您可以操作输入参数和/或输出。</p>
                            <p _msthash="389559" _msttexthash="33239024">可以通过执行：</p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">before</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'start'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$params</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// Do something</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="390261" _msttexthash="33239024">可以通过执行：</p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">after</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'start'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$params</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// Do something</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="390963" _msttexthash="282067279">您可以根据需要向任何方法添加尽可能多的筛选。将按声明的顺序调用它们。</p>
                            <p _msthash="405627" _msttexthash="59550816">下面是筛选过程的示例：</p>
                            <pre class="language-php"><code class="language-php"><span class="token comment">// Map a custom method</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">map</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'hello'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token double-quoted-string string">"Hello, <span class="token interpolation"><span class="token variable">$name</span></span>!"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Add a before filter</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">before</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'hello'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$params</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// Manipulate the parameter</span>
    <span class="token variable">$params</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'Fred'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Add an after filter</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">after</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'hello'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$params</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// Manipulate the output</span>
    <span class="token variable">$output</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token double-quoted-string string">" Have a nice day!"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Invoke the custom method</span>
<span class="token keyword">echo</span> <span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Bob'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="406355" _msttexthash="22304659">这应显示：</p>
                            <pre class="language-html"><code class="language-html">Hello Fred! Have a nice day!
</code></pre>
                            <p>
                                <font _mstmutation="1" _msthash="407083" _msttexthash="239929677">
                                    如果定义了多个筛选，可以通过返回任何筛选函数来断开链：</font><code>false</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">before</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'start'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$params</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'one'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">before</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'start'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$params</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'two'</span><span class="token punctuation">;</span>

    <span class="token comment">// This will end the chain</span>
    <span class="token keyword">return</span> <span class="token boolean constant">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// This will not get called</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">before</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'start'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$params</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'three'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p>
                                <font _mstmutation="1" _msthash="407811" _msttexthash="334009845">请注意，核心方法（如 和
                                    ）无法筛选，因为它们是直接调用的，不会动态调用。</font><code>map</code><code>register</code>
                            </p>
                        </div>
                        <div>
                            <h1><a name="variables"></a>
                                <font _mstmutation="1" _msthash="402978" _msttexthash="5835232">变量</font>
                            </h1>
                            <p _msthash="388158" _msttexthash="212126187">CMS允许您保存变量，以便它们可以在应用程序中的任意位置使用。</p>
                            <pre class="language-php"><code class="language-php"><span class="token comment">// Save your variable</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">set</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Elsewhere in your application</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="388858" _msttexthash="114898004">若要查看是否设置了变量，可以进行：</p>
                            <pre class="language-php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">has</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment">// Do something</span>
<span class="token punctuation">}</span>
</code></pre>
                            <p _msthash="389560" _msttexthash="27096238">您可以通过：</p>
                            <pre class="language-php"><code class="language-php"><span class="token comment">// Clears the id variable</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Clears all variables</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="390262" _msttexthash="59418255">CMS还使用变量进行配置。</p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">set</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'web.log_errors'</span><span class="token punctuation">,</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                        </div>
                        <div>
                            <h1><a name="views"></a>
                                <font _mstmutation="1" _msthash="402979" _msttexthash="5525650">视图</font>
                            </h1>
                            <p>
                                <font _mstmutation="1" _msthash="388159" _msttexthash="701972284">
                                    默认情况下，CMS提供了一些基本的模板化功能。要显示视图模板调用具有模板文件和可选模板数据名称的方法，请执行：</font><code>render</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">render</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'hello.php'</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'Bob'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p>
                                <font _mstmutation="1" _msthash="388859" _msttexthash="598562367">
                                    您传递的模板数据会自动注入到模板中，可以像局部变量一样进行引用。模板文件只是PHP文件。如果模板文件的内容为：</font><code>hello.php</code>
                            </p>
                            <pre class="language-php"><code class="language-php">Hello, '<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token variable">$name</span><span class="token punctuation">;</span> <span class="token delimiter important">?&gt;</span></span>'!
</code></pre>
                            <p _msthash="389561" _msttexthash="16360071">输出为：</p>
                            <pre class="language-html"><code class="language-html">Hello, Bob!
</code></pre>
                            <p _msthash="390263" _msttexthash="108928872">还可以使用 set 方法手动设置视图变量：</p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'name'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'Bob'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p>
                                <font _mstmutation="1" _msthash="390964" _msttexthash="158103816">该变量现在在所有视图中都可用。因此，您只需：
                                </font><code>name</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">render</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p>
                                <font _mstmutation="1" _msthash="405991" _msttexthash="191890244">
                                    请注意，在渲染方法中指定模板的名称时，可以删除扩展名。</font><code>.php</code>
                            </p>
                            <p>
                                <font _mstmutation="1" _msthash="406356" _msttexthash="448922968">默认情况下，Api
                                    将查找模板文件的目录。您可以通过设置以下配置为模板设置备用路径：</font><code>views</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">set</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'web.views.path'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'/path/to/views'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <h2 _msthash="423280" _msttexthash="4646161">布局</h2>
                            <p>
                                <font _mstmutation="1" _msthash="407446" _msttexthash="536523650">
                                    网站通常具有具有交换内容的单个布局模板文件。若要呈现要在布局中使用的内容，可以将可选参数传递给 方法。</font><code>render</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">render</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'header'</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'heading'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'Hello'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'header_content'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">render</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'body'</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'body'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'World'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'body_content'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p>
                                <font _mstmutation="1" _msthash="408174" _msttexthash="180537084">然后，视图将保存名为 和
                                    的变量。然后，您可以通过：</font><code>header_content</code><code>body_content</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">render</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'layout'</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'title'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'Home Page'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="408903" _msttexthash="51637872">如果模板文件如下所示：</p>
                            <p><code>header.php</code>
                                <font _mstmutation="1" _msthash="405977" _msttexthash="5278">:</font>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token variable">$heading</span><span class="token punctuation">;</span> <span class="token delimiter important">?&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
</code></pre>
                            <p><code>body.php</code>
                                <font _mstmutation="1" _msthash="406705" _msttexthash="5278">:</font>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token variable">$body</span><span class="token punctuation">;</span> <span class="token delimiter important">?&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre>
                            <p><code>layout.php</code>
                                <font _mstmutation="1" _msthash="407434" _msttexthash="5278">:</font>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token variable">$title</span><span class="token punctuation">;</span> <span class="token delimiter important">?&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token variable">$header_content</span><span class="token punctuation">;</span> <span class="token delimiter important">?&gt;</span></span>
<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token variable">$body_content</span><span class="token punctuation">;</span> <span class="token delimiter important">?&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre>
                            <p _msthash="408162" _msttexthash="16360071">输出为：</p>
                            <pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Home Page<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Hello<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>World<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre>
                            <h2 _msthash="425152" _msttexthash="15579785">自定义视图</h2>
                            <p _msthash="409253" _msttexthash="428216360">CMS允许您通过注册自己的视图类来交换默认视图引擎。以下是如何使用<a
                                    href="http://www.smarty.net/" _istranslated="1">Smarty 模板</a>引擎查看视图：</p>
                            <pre class="language-php"><code class="language-php"><span class="token comment">// Load Smarty library</span>
<span class="token keyword">require</span> <span class="token single-quoted-string string">'./Smarty/libs/Smarty.class.php'</span><span class="token punctuation">;</span>

<span class="token comment">// Register Smarty as the view class</span>
<span class="token comment">// Also pass a callback function to configure Smarty on load</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">register</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'view'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'Smarty'</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$smarty</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token variable">$smarty</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">template_dir</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'./templates/'</span><span class="token punctuation">;</span>
    <span class="token variable">$smarty</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">compile_dir</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'./templates_c/'</span><span class="token punctuation">;</span>
    <span class="token variable">$smarty</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">config_dir</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'./config/'</span><span class="token punctuation">;</span>
    <span class="token variable">$smarty</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">cache_dir</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'./cache/'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Assign template data</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'name'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'Bob'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Display the template</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'hello.tpl'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="406692" _msttexthash="147788082">对于完整性，还应覆盖CMS的默认渲染方法：</p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">map</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'render'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                        </div>
                        <div>
                            <h1><a name="errorhandling"></a>
                                <font _mstmutation="1" _msthash="402980" _msttexthash="13726427">错误处理</font>
                            </h1>
                            <h2 _msthash="403676" _msttexthash="16342339">错误和异常</h2>
                            <p>
                                <font _mstmutation="1" _msthash="388507" _msttexthash="401685440">所有错误和异常由 Api
                                    捕获并传递给方法。默认行为是发送包含一些错误信息的通用响应。</font>
                                <code>error</code><code>HTTP 500 Internal Server Error</code>
                            </p>
                            <p _msthash="388860" _msttexthash="109223972">您可以覆盖此行为以满足自己的需要：</p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">map</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'error'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>Exception <span class="token variable">$ex</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// Handle error</span>
    <span class="token keyword">echo</span> <span class="token variable">$ex</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">getTraceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="389562" _msttexthash="314346227">默认情况下，错误不会记录到 Web 服务器。您可以通过更改配置来启用此功能：</p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">set</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'web.log_errors'</span><span class="token punctuation">,</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <h2 _msthash="405860" _msttexthash="7487246">未找到</h2>
                            <p>
                                <font _mstmutation="1" _msthash="390612" _msttexthash="301510885">当找不到 URL 时，Api
                                    会调用该方法。默认行为是发送包含简单消息的响应。</font><code>notFound</code><code>HTTP 404 Not Found</code>
                            </p>
                            <p _msthash="390965" _msttexthash="109223972">您可以覆盖此行为以满足自己的需要：</p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">map</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'notFound'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// Handle not found</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                        </div>
                        <div>
                            <h1><a name="redirects"></a>
                                <font _mstmutation="1" _msthash="402981" _msttexthash="8353332">重 定向</font>
                            </h1>
                            <p>
                                <font _mstmutation="1" _msthash="388160" _msttexthash="130886808">您可以使用 方法重定向当前请求并传递新的
                                    URL：</font><code>redirect</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/new/location'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="388861" _msttexthash="268786492">默认情况下，CMS发送 HTTP 303 状态代码。您可以选择设置自定义代码：</p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/new/location'</span><span class="token punctuation">,</span> <span class="token number">401</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                        </div>
                        <div>
                            <h1><a name="requests"></a>
                                <font _mstmutation="1" _msthash="402982" _msttexthash="6142877">请求</font>
                            </h1>
                            <p _msthash="388161" _msttexthash="310543909">Api 将 HTTP 请求封装到单个对象中，可以通过以下操作访问该对象：</p>
                            <pre class="language-php"><code class="language-php"><span class="token variable">$request</span> <span class="token operator">=</span> <span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="388862" _msttexthash="51615499">请求对象提供以下属性：</p>
                            <pre class="language-html"><code class="language-html">url - The URL being requested
base - The parent subdirectory of the URL
method - The request method (GET, POST, PUT, DELETE)
referrer - The referrer URL
ip - IP address of the client
ajax - Whether the request is an AJAX request
scheme - The server protocol (http, https)
user_agent - Browser information
type - The content type
length - The content length
query - Query string parameters
data - Post data or JSON data
cookies - Cookie data
files - Uploaded files
secure - Whether the connection is secure
accept - HTTP accept parameters
proxy_ip - Proxy IP address of the client
</code></pre>
                            <p>
                                <font _mstmutation="1" _msthash="389563" _msttexthash="73950370">可以访问 、 和 属性作为数组或对象。
                                </font><code>query</code><code>data</code><code>cookies</code><code>files</code>
                            </p>
                            <p _msthash="389911" _msttexthash="131514175">因此，要获取查询字符串参数，可以执行：</p>
                            <pre class="language-php"><code class="language-php"><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">query</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="390613" _msttexthash="33809373">或者，您可以：</p>
                            <pre class="language-php"><code class="language-php"><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">query</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">id</span><span class="token punctuation">;</span>
</code></pre>
                            <h2 _msthash="421773" _msttexthash="20119541">原始请求正文</h2>
                            <p _msthash="405992" _msttexthash="285726415">若要获取原始 HTTP 请求正文，例如在处理 PUT 请求时，可以以下网址说：</p>
                            <pre class="language-php"><code class="language-php"><span class="token variable">$body</span> <span class="token operator">=</span> <span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <h2 _msthash="422903" _msttexthash="8541286">JSON 输入</h2>
                            <p>
                                <font _mstmutation="1" _msthash="407084" _msttexthash="174971680">如果发送具有类型和数据的请求，它将从
                                    属性中获得：</font><code>application/json</code><code>{"id": 123}</code><code>data</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">data</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">id</span><span class="token punctuation">;</span>
</code></pre>
                        </div>
                        <div>
                            <h1><a name="stopping"></a>
                                <font _mstmutation="1" _msthash="402983" _msttexthash="4731012">停止</font>
                            </h1>
                            <p>
                                <font _mstmutation="1" _msthash="388162" _msttexthash="95996485">您可以通过调用 方法随时停止框架：
                                </font><code>halt</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">halt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p>
                                <font _mstmutation="1" _msthash="388863" _msttexthash="98485569">您还可以指定可选的状态代码和消息：
                                </font><code>HTTP</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">halt</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'Be right back...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p>
                                <font _mstmutation="1" _msthash="389564" _msttexthash="373136478">
                                    调用将丢弃任何响应内容，但到该点。如果要停止框架并输出当前响应，请使用 方法：</font><code>halt</code><code>stop</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                        </div>
                        <div>
                            <h1><a name="httpcaching"></a>
                                <font _mstmutation="1" _msthash="402984" _msttexthash="8335353">HTTP 缓存</font>
                            </h1>
                            <p>
                                <font _mstmutation="1" _msthash="388163" _msttexthash="928120960">CMS为 HTTP
                                    级缓存提供内置支持。如果满足缓存条件，CMS将返回 HTTP 响应。下次客户端请求同一资源时，系统将提示他们使用其本地缓存的版本。</font>
                                <code>304 Not Modified</code>
                            </p>
                            <h2 _msthash="404041" _msttexthash="10432942">上次修改</h2>
                            <p>
                                <font _mstmutation="1" _msthash="388864" _msttexthash="756416544">您可以使用 该方法并在 UNIX
                                    时间戳中传递来设置上次修改页面的日期和时间。客户端将继续使用其缓存，直到更改最后一个修改的值。</font><code>lastModified</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/news'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">lastModified</span><span class="token punctuation">(</span><span class="token number">1234567890</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'This content will be cached.'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <h2 _msthash="405133" _msttexthash="43082">Etag</h2>
                            <p><code>ETag</code>
                                <font _mstmutation="1" _msthash="389912" _msttexthash="135085392">缓存与 类似，但您可以指定资源需要的任何
                                    ID：</font><code>Last-Modified</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/news'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">etag</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'my-unique-id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'This content will be cached.'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p>
                                <font _mstmutation="1" _msthash="390614" _msttexthash="485034394">请记住，调用 或
                                    将同时设置并检查缓存值。如果请求之间的缓存值相同，Api 将立即发送响应并停止处理。</font>
                                <code>lastModified</code><code>etag</code><code>HTTP 304</code>
                            </p>
                        </div>
                        <div>
                            <h1><a name="json"></a>
                                <font _mstmutation="1" _msthash="402985" _msttexthash="45981">Json</font>
                            </h1>
                            <p _msthash="388164" _msttexthash="391336023">CMS为发送 JSON 和 JSONP 响应提供支持。要发送 JSON 响应，请传递一些要编码
                                JSON 的数据：</p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">json</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'id'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="388865" _msttexthash="256863113">对于 JSONP 请求，可以选择传递用于定义回调函数的查询参数名称：</p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">jsonp</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'id'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'q'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p>
                                <font _mstmutation="1" _msthash="389565" _msttexthash="140070385">因此，在使用 进行 GET
                                    请求时，应接收输出：</font><code>?q=my_func</code>
                            </p>
                            <pre class="language-json"><code class="language-json">my_func(<span class="token punctuation">{</span><span class="token property">"id"</span><span class="token operator">:</span><span class="token number">123</span><span class="token punctuation">}</span>);
</code></pre>
                            <p>
                                <font _mstmutation="1" _msthash="390264" _msttexthash="103967682">如果不传递查询参数名称，它将默认为 。
                                </font><code>jsonp</code>
                            </p>
                        </div>
                        <div>
                            <h1><a name="configuration"></a>
                                <font _mstmutation="1" _msthash="402986" _msttexthash="6777615">配置</font>
                            </h1>
                            <p>
                                <font _mstmutation="1" _msthash="388165" _msttexthash="159160183">
                                    您可以通过方法设置配置值来自定义CMS的某些行为。</font><code>set</code>
                            </p>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">set</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'web.log_errors'</span><span class="token punctuation">,</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="388866" _msttexthash="89418238">以下是所有可用配置设置的列表：</p>
                            <pre class="language-html"><code class="language-html">web.base_url - Override the base url of the request. (default: null)
web.case_sensitive - Case sensitive matching for URLs. (default: false)
web.handle_errors - Allow Api to handle all errors internally. (default: true)
web.log_errors - Log errors to the web server's error log file. (default: false)
web.views.path - Directory containing view template files. (default: ./views)
web.views.extension - View template file extension. (default: .php)
</code></pre>
                        </div>
                        <div>
                            <h1><a name="frameworkmethods"></a>
                                <font _mstmutation="1" _msthash="402987" _msttexthash="11859081">框架方法</font>
                            </h1>
                            <p _msthash="388166" _msttexthash="847899273">
                                CMS设计简单易懂。以下是框架的完整方法集。它由核心方法（常规静态方法和可扩展方法）组成，这些方法是可筛选或重写的映射方法。</p>
                            <h2 _msthash="404042" _msttexthash="11646167">核心方法</h2>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">map</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$callback</span><span class="token punctuation">)</span> <span class="token comment">// Creates a custom framework method.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">register</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$class</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token variable">$params</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token variable">$callback</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// Registers a class to a framework method.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">before</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$callback</span><span class="token punctuation">)</span> <span class="token comment">// Adds a filter before a framework method.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">after</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$callback</span><span class="token punctuation">)</span> <span class="token comment">// Adds a filter after a framework method.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">path</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span> <span class="token comment">// Adds a path for autoloading classes.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span> <span class="token comment">// Gets a variable.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">set</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token comment">// Sets a variable.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">has</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span> <span class="token comment">// Checks if a variable is set.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 清除变量.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 将框架初始化为其默认设置.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 获取应用程序对象实例.</span>
</code></pre>
                            <h2 _msthash="404768" _msttexthash="14710371">可扩展方法</h2>
                            <pre class="language-php"><code class="language-php"><span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 启动框架.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 停止框架并发送响应.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">halt</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token variable">$code</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token variable">$message</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 使用可选的状态代码和消息停止框架.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">route</span><span class="token punctuation">(</span><span class="token variable">$pattern</span><span class="token punctuation">,</span> <span class="token variable">$callback</span><span class="token punctuation">)</span> <span class="token comment">// 映射一个URL模式回调.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token variable">$code</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 重定向到另一个URL.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">render</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token variable">$data</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 呈现模板文件.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">error</span><span class="token punctuation">(</span><span class="token variable">$exception</span><span class="token punctuation">)</span> <span class="token comment">// 发送HTTP 500响应.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">notFound</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 发送HTTP 404响应.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">etag</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token variable">$type</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 执行ETag HTTP缓存.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">lastModified</span><span class="token punctuation">(</span><span class="token variable">$time</span><span class="token punctuation">)</span> <span class="token comment">// 执行上次修改的HTTP缓存.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">json</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token variable">$code</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token variable">$encode</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token variable">$charset</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token variable">$option</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 发送JSON响应.</span>
<span class="token scope">Api<span class="token punctuation">::</span></span><span class="token function">jsonp</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token variable">$param</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token variable">$code</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token variable">$encode</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token variable">$charset</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token variable">$option</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 发送一个JSONP响应.</span>
</code></pre>
                            <p>
                                <font _mstmutation="1" _msthash="389913" _msttexthash="120598153">使用 和
                                    添加的任何自定义方法也可以进行筛选。</font><code>map</code><code>register</code>
                            </p>
                        </div>
                        <div>
                            <h1><a name="frameworkinstance"></a>
                                <font _mstmutation="1" _msthash="402988" _msttexthash="10581662">框架实例</font>
                            </h1>
                            <p _msthash="388167" _msttexthash="258275485">您可以选择将 Api 作为全局静态类运行，而是作为对象实例运行它。</p>
                            <pre class="language-php"><code class="language-php"><span class="token keyword">require</span> <span class="token single-quoted-string string">'app/autoload.php'</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">app<span class="token punctuation">\</span>Engine</span><span class="token punctuation">;</span>

<span class="token variable">$app</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Engine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'hello world!'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                            <p _msthash="388867" _msttexthash="305583954">因此，您不是调用静态方法，而是在 Engine 对象上调用具有相同名称的实例方法。</p>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>
</body>

</html>